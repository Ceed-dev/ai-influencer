# AI-Influencer - Context

This file maintains the complete project history for AI continuity.

## Project Purpose

Manage the complete AI influencer video production lifecycle: component management, video production planning, multi-platform analytics (YouTube Shorts / TikTok / Instagram Reels), and AI-driven improvement recommendations.

## Key IDs and Resources

| Resource | ID / URL |
|----------|----------|
| Master Spreadsheet | `1fI1s_KLcegpiACJYpmpNe9tnQmnZo2o8eHIXNV5SpPg` |
| Apps Script Project | `1nbGkujRb6PwtkVuxBh1Vb9NKIUFi_uBa8NbdPSEx_PoxREmyMUKivA0S` |
| Root Drive Folder (AI-Influencer) | `1KRQuZ4W7u5CXRamjvN4xmavfu-7TPb0X` |
| Web App Deployment URL | `https://script.google.com/macros/s/{DEPLOYMENT_ID}/exec` (created via `clasp deploy`) |
| GitHub Repository | `Ceed-dev/ai-influencer` (æ—§: `video-analytics-hub`) |

### Inventory Spreadsheet IDs (stored in Script Properties)

These are auto-generated by `setupCompleteSystem()` and stored in GAS Script Properties:
- `SCENARIOS_INVENTORY_ID`
- `MOTIONS_INVENTORY_ID`
- `CHARACTERS_INVENTORY_ID`
- `AUDIO_INVENTORY_ID`


## Session History

### 2026-02-06: Project Initialization (v1.0)

**What was done:**
- Created project folder structure
- Created initial documentation (README.md, ARCHITECTURE.md, CONTEXT.md)
- Defined GAS project structure with component breakdown
- Established Google Sheets schema for multi-platform metrics

**Key decisions:**
1. **GAS over GCP VM**: Chose Google Apps Script for simplicity and native Sheets integration
2. **video_uid linking**: Each video gets a unique ID to link across platforms
3. **CSV-first approach**: Platform APIs have severe limitations. CSV export is the primary data source

### 2026-02-06: Phase 2-5 Implementation (v1.0)

**What was done:**
- CSV parsers, normalizers, linkers, KPI engine, LLM analyzer, sheet writer
- 223 tests across 6 test suites
- n8n integration documentation
- Sample CSV files

### 2026-02-09: Complete v2.0 Rebuild

**Why v2.0 was needed:**
- v1.0 was analytics-only (CSV import and analysis). It had no concept of video production lifecycle, no component management, and no way to track which content elements contributed to performance.
- v2.0 adds the complete production loop: component inventories, production workflow, approval gates, component-aware AI analysis, and performance scoring.

**What was done:**

- **Phase 1: Foundation**
  - `Config.gs` - Complete rewrite with Drive structure, master columns, component types, ID prefixes, KPI defaults, column aliases, dropdown options, colors
  - `Utils.gs` - Added readSheetAsObjects, findRowByColumn, findAllRowsByColumn, updateRowByIndex, ID generators (generateVideoUid, generateComponentId, generateScenarioId, generateMotionId, generateCharacterId, generateAudioId), getInventoryTypeFromId, getComponentById, getComponentsById
  - `Setup.gs` - One-click system setup: creates Drive folders (Scenarios/Motions/Characters/Audio/Analytics with subfolders), inventory spreadsheets (4 separate spreadsheets), all master sheet tabs, demo data, KPI defaults, formatting (dropdowns, conditional colors, checkbox)
  - `Migration.gs` - v1 to v2 migration (renames videos_master to master, adds new columns, creates video_analysis sheet, updates recommendations schema)

- **Phase 2: Data Layer**
  - `ComponentManager.gs` (NEW) - Component CRUD (addComponent, updateComponent, archiveComponent), listComponents with filters (type/status/tags), getTopPerformingComponents, buildVideoComponentContext, incrementComponentUsage, getComponentPerformanceHistory, buildRecommendationComponentPool
  - `MasterManager.gs` (NEW) - Master sheet operations (createProduction, getVideosByStatus, getApprovedVideos, getProductionData), production workflow (updateVideoStatus, approveVideo), updateMetricsSnapshot, writeAIRecommendations, updateAnalysisResults, getAllVideoUids, getMasterData
  - `ScoreUpdater.gs` (NEW) - updateAllComponentScores, calculateAvgScore, updateComponentScoresForVideo, updateSingleComponentScore, normalizeOverallScore, getScoreSummary

- **Phase 3: Analysis Extension**
  - `LLMAnalyzer.gs` - Rewritten with component-aware prompts (analyzWithLLMEnhanced), includes component history and top performers in AI context, generates component-specific recommendations via separate prompt, single-video analysis with component context
  - `Linker.gs` - Updated for v2.0 master sheet references, added updateMasterMetricsSnapshot
  - `KPIEngine.gs` - Added normalizeOverallScore for cross-platform scoring
  - `SheetWriter.gs` - Added writeToInventory, writeVideoAnalysis, writeRecommendationsEnhanced, clearAllData

- **Phase 4: Integration**
  - `Code.gs` - Complete rewrite with 13 API actions (doGet: get_status, get_approved, get_production, get_components, get_score_summary; doPost: import_csv, analyze, analyze_single, analyze_all, link_videos, create_production, approve_video, update_status, add_component, update_component, get_components, update_scores)
  - UI menu with submenus: Import CSV (YouTube/TikTok/Instagram), Analyze (Single/All), Production (Create/Approve/Status), Components (Add/Browse/Scores)

- **Phase 5: Testing**
  - 3 new test files: ComponentManager.test.js, MasterManager.test.js, ScoreUpdater.test.js
  - Updated all existing tests for v2.0 (master sheet references, removed scenario_cuts)
  - Updated setup.js with all v2.0 utility mocks
  - **330 tests passing across 9 test suites**

- **Phase 6: Documentation**
  - Updated all documentation for v2.0

**Key v2.0 decisions:**
1. **Separate inventory spreadsheets**: Each component type (scenarios, motions, characters, audio) has its own spreadsheet, accessed via `SpreadsheetApp.openById()`
2. **Component ID system**: Prefix-based (SCN_H_, SCN_B_, SCN_C_, MOT_, CHR_, AUD_) for type identification
3. **Production workflow**: draft -> approved -> in_production -> published -> analyzed, with human approval gate
4. **Component-aware AI analysis**: AI receives full component context (history, scores, top performers) when analyzing

### 2026-02-09: v2.0.1 - Checkbox Bug Fix

**Problem:** The `human_approved` checkbox column in the master sheet was causing `getLastRow()` to return 101 instead of 2 (or the actual data row count), because `requireCheckbox()` data validation auto-fills `FALSE` into empty cells, making them appear as data rows.

**Fix:** Changed `applyMasterSheetFormatting_()` to only apply checkbox validation to rows that have actual data (checked `sheet.getLastRow()` before applying), rather than applying to a range of 100 rows.

**Commit:** `62f7400 Fix insertDemoData false positive: checkbox FALSE values triggered data check`

### 2026-02-09: v2.0.2 - appendRow Bug Fix

**Problem:** Because of the checkbox FALSE values filling up to row 101, `sheet.appendRow()` was writing new data at row 102 instead of the next available row after actual data.

**Fix:** Updated `insertDemoData()` to clear any existing rows (including checkbox FALSE values) before writing demo data, and then apply checkbox validation only to the data rows.

**Commit:** `4c36712 Fix checkbox causing appendRow to write at row 101 instead of row 2`

### 2026-02-09: v2.0.3 - Config Sheet Fallback for API Keys

**Problem:** Setting Script Properties via the Apps Script editor is cumbersome, especially for the OpenAI API key. The `_config` sheet in the spreadsheet provides a more accessible way to store configuration.

**What changed:**
- `Config.gs`: Added `getConfigFromSheet_()` function that reads from a `_config` sheet (columns: key, value, description) as a fallback when Script Properties are not set
- `Config.gs`: Added `migrateConfigToProperties()` to migrate _config sheet values to Script Properties
- `OPENAI_API_KEY` now reads from Script Properties first, then falls back to `_config` sheet

### 2026-02-09: v2.0.4 - Web App Access Configuration

**Problem:** The Web App was not accessible externally because `appsscript.json` had `oauthScopes` configured (for bound script) but no `webapp` section. The webapp needed to be accessible without authentication for n8n integration.

**What changed:**
- `appsscript.json`: Replaced `oauthScopes` array with `webapp` configuration:
  ```json
  "webapp": {
    "access": "ANYONE_ANONYMOUS",
    "executeAs": "USER_DEPLOYING"
  }
  ```
- This allows anyone with the deployment URL to access the Web App endpoints
- OAuth scopes are inferred automatically by GAS for bound scripts

### 2026-02-09: OAuth Setup for Google Sheets/Drive API

**Purpose:** Enable Claude Code to directly read/write to Google Sheets and Drive for E2E testing and debugging.

**What was set up:**
- Created OAuth 2.0 credentials in Google Cloud Console (project: video-analytics-hub)
- Created `scripts/gsheet.py` CLI utility for direct Sheets/Drive API access
- Token stored in `.gsheets_token.json` (gitignored)
- OAuth client credentials in `video_analytics_hub_claude_code_oauth.json` (gitignored)
- MCP servers configured in `.mcp.json` for google-workspace and google-sheets integration (gitignored)

### 2026-02-09: E2E Testing Results

**End-to-end testing was performed against the live spreadsheet:**
- Confirmed all 9 sheet tabs exist with correct headers
- Confirmed master sheet has 3 demo videos (2 analyzed, 1 draft)
- Confirmed metrics sheets have data for analyzed videos
- Confirmed KPI targets are set with default values
- Confirmed component inventories are connected and populated with demo data
- All 330 unit tests pass

### 2026-02-09: LLM Analysis Execution (Live Test)

**Live test of the analysis pipeline was verified:**
- OpenAI API key configured via `_config` sheet (auto-migrated to Script Properties)
- `analyzeVideoSingle` and `analyzeAllVideosEnhanced` functions tested via GAS editor execution
- Analysis writes to `video_analysis` and `recommendations` sheets
- Component scores updated after analysis
- AI-recommended components written to `ai_next_*` columns

### 2026-02-09: MANUAL.md Creation

**Created comprehensive Japanese-language user manual (`MANUAL.md`):**
- Complete system overview with architecture diagrams (ASCII art)
- Detailed Google Drive data structure documentation
- All spreadsheet schemas with column descriptions
- Component management workflows
- Video production lifecycle documentation
- CSV import procedures for all 3 platforms
- Analysis and KPI explanation
- AI recommendation and approval flow
- n8n/API integration guide with all endpoint specifications
- GAS menu operation guide
- Troubleshooting section
- Initial setup instructions

### 2026-02-09: v2.1.0 - Documentation Update and .gitignore Hardening

**What was done:**
- Updated CONTEXT.md with complete project history
- Added `.mcp.json` and `tmp/` to `.gitignore` to prevent credential leaks
- Verified all documentation files are consistent with v2.0 codebase
- Committed, pushed, and deployed to Apps Script

### 2026-02-09: v3.0.0 - AI-Influencer Pipeline

**Why:** Pivot from analytics-only tool to a full content production pipeline. The existing GAS analytics (v2.0) handles post-publication analysis well, but the upstream workflow (video generation â†’ platform posting) was manual via n8n. This version adds an automated Node.js pipeline to handle end-to-end content production at scale (50 â†’ 700 accounts).

**What was done:**

- **Project restructure**: Renamed conceptually from "Video Analytics Hub" to "AI-Influencer" to reflect the broader scope
- **Created `pipeline/` directory** with modular Node.js architecture:
  - `pipeline/config.js` - Environment configuration and API key management
  - `pipeline/orchestrator.js` - Pipeline orchestration (scenario â†’ video â†’ post)
  - `pipeline/sheets/reader.js` - Google Sheets API reader (scenarios, accounts)
  - `pipeline/sheets/writer.js` - Google Sheets API writer (pipeline status, results)
  - `pipeline/media/kling.js` - fal.ai Kling video generation
  - `pipeline/media/tts.js` - fal.ai ElevenLabs TTS
  - `pipeline/media/lipsync.js` - fal.ai Lipsync processing
  - `pipeline/media/creatify.js` - Creatify video composition
  - `pipeline/storage/drive.js` - Google Drive upload/management
  - `pipeline/posting/youtube.js` - YouTube Data API v3 posting
  - `pipeline/posting/instagram.js` - Instagram Graph API posting
  - `pipeline/posting/tiktok.js` - TikTok Content Posting API
  - `pipeline/posting/x.js` - X/Twitter v2 API posting
- **Created `scripts/` entry points**:
  - `scripts/run-pipeline.js` - Single video pipeline execution
  - `scripts/run-daily.js` - Daily batch execution for all accounts
  - `scripts/collect-metrics.js` - Metrics collection from platforms
- **New Google Sheets tabs designed**:
  - `accounts` - Platform account management (account_id, platform, credentials_ref, status, daily limits)
  - `content_pipeline` - Pipeline execution log (pipeline_id, video_uid, account_id, job IDs, status, cost)
- **Documentation rewrite**:
  - `STRATEGY.md` (NEW) - Strategy, KPI targets, revenue model, meeting notes, decision log
  - `README.md` - Complete rewrite for AI-Influencer scope
  - `ARCHITECTURE.md` - Complete rewrite with Pipeline + Analytics architecture
  - `CONTEXT.md` - Appended this session

**Key decisions:**
1. **Node.js pipeline (not GAS)**: GAS has 6-minute timeout and can't handle long-running video generation. Node.js runs on local/server with no timeout constraints
2. **fal.ai as media hub**: Consolidates Kling, ElevenLabs, and Lipsync under one API provider
3. **Google Sheets as DB**: Continues using Sheets for simplicity and compatibility with existing GAS analytics
4. **YouTube first for MVP**: Most stable API, fastest path to revenue
5. **Existing GAS analytics unchanged**: The 14 GAS files and 330 tests remain untouched

**Phase plan:**
- Phase 1 (2/10-12): MVP - 1 account, YouTube auto-posting
- Phase 2 (2/13-17): 12 YouTube + 12 Instagram accounts
- Phase 3 (2/18-28): All 50 accounts across 4 platforms

### 2026-02-10: Phase 0 - Content Generation Pipeline Implementation

**Why:** The n8n workflow analysis revealed 5 critical differences between the existing pipeline code and the actual production workflow. The pipeline needed to be rewritten to match the real n8n flow exactly.

**What was done:**

- **n8n workflow analysis**: Analyzed `ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼.json` and `senario_template.xlsx` to extract the real 3-step process (Kling â†’ TTS â†’ Lipsync, no Creatify Aurora)
- **Created `pipeline/data/scenario.json`**: Extracted 3 sections (hook, body, cta) with scripts and motion reference video Drive IDs (`motionVideoDriveId`)
- **Fixed media module endpoints**:
  - `video-generator.js`: `image-to-video` â†’ `motion-control` with `video_url`, `character_orientation` (NO `prompt` or `keep_original_sound` â€” causes 422)
  - `tts-generator.js`: `tts/v3` â†’ `tts/eleven-v3` with voice name "Aria" instead of voice_id
  - `lipsync.js`: `v2` â†’ `v2/pro` with `sync_mode: "bounce"`
- **Added fal.storage upload**: `uploadToFalStorage()` and `downloadFromDrive()` in `fal-client.js` â€” replaces Cloudinary with Drive â†’ fal.storage â†’ API pattern
- **Created ffmpeg concat utility**: `pipeline/media/concat.js` using concat demuxer for combining 3 section videos
- **Rewrote orchestrator**: New 3-section loop â€” downloads motion video from Drive per section â†’ fal.storage â†’ Kling â†’ TTS â†’ Lipsync, then ffmpeg concat + Drive upload (4 files) + sheet logging
- **Rewrote CLI**: `--character-folder <DRIVE_FOLDER_ID>` replaces `--account`
- **Deleted Cloudinary and Compositor modules**: Removed `compositor.js`, `cloudinary.js`, cloudinary config and dependency
- **Updated content_pipeline sheet schema**: New columns (character_folder_id, section_count, hook/body/cta_video_url, drive_folder_id)
- **Updated content-manager.js**: HEADERS array matches new sheet schema
- **Created pipeline test suite**: 21 tests covering modules, endpoints, ffmpeg, CLI, schema, edge cases
- **Updated Jest config**: Projects-based config for both GAS and pipeline test suites
- **E2E success**: First full pipeline run completed â€” CNT_202602_2916 (54MB final video, 3 sections)
  - Uploaded CHR_0001_v1.jpg to `Characters/Images/CHR_0001/`
  - Fixed `FAL_KEY || FAL_AI_KEY` fallback in config.js
  - Replaced dead Cloudinary URLs in scenario.json with Drive file IDs (motionVideoDriveId)
  - Removed invalid `prompt: ''` and `keep_original_sound: true` params from video-generator
  - Output: `Productions/2026-02-10/CNT_202602_2916/` with 4 MP4 files uploaded to Drive
  - content_pipeline sheet updated with status=completed and all Drive links
- **README.md rewritten**: Comprehensive specification document with pipeline flow, service descriptions, Drive folder structure, all Sheets schemas with column-level documentation, setup, usage, cost structure

**Key decisions:**
1. **Creatify Aurora removed**: n8n workflow doesn't use it â€” the 3-step process (Kling â†’ TTS â†’ Lipsync) is sufficient
2. **Cloudinary â†’ fal.storage**: All persistent files in Drive, temporary URLs via fal.storage. No external image hosting needed
3. **3-section structure**: Each video consists of hook + body + cta, processed independently then concatenated
4. **ffmpeg for concatenation**: Simple `concat demuxer` with `-c copy` (no re-encoding) for fast joining
5. **Drive folder structure**: Productions/YYYY-MM-DD/CNT_XXXX/ with 4 files per content
6. **Motion videos from Drive**: scenario.json stores Drive file IDs (not URLs), orchestrator downloads + uploads to fal.storage per section

**Test results:** 357 tests passing (330 GAS + 27 pipeline)

### 2026-02-10: v4.0 - Production Rebuild

**Why:** Phase 0 proved the E2E pipeline works, but it relied on demo data and sequential processing. To hit the 36 videos/day target for 50 accounts by February, the system needed: (1) real data in all inventories, (2) parallel processing for speed, (3) proper inventory management modules, and (4) a production-grade tracking tab.

**What was done:**

- **Demo data â†’ real data migration**:
  - Cleared all demo data from 4 inventory spreadsheets (Scenarios, Motions, Characters, Audio)
  - Populated inventories with real data from ãƒ†ãƒ³ãƒ—ãƒ¬.xlsx
  - Uploaded 3 motion videos to Drive (Hooks/Bodies/CTAs folders)

- **Accounts Inventory** (new spreadsheet):
  - 7 platform accounts configured
  - 12 Gmail credentials registered

- **Production tab** (new, 32 columns):
  - Replaces content_pipeline for new pipeline runs
  - Tracks video_id, all inventory IDs used, scripts, output URLs, processing time, cost, error details
  - content_pipeline tab preserved for backward compatibility (v3.1 records remain)

- **New pipeline modules**:
  - `pipeline/sheets/inventory-reader.js`: Reads from all 4 inventory spreadsheets, resolves component IDs to Drive file IDs and metadata
  - `pipeline/sheets/production-manager.js`: Creates/updates rows in the production tab, manages status transitions

- **Orchestrator parallelization** (`pipeline/orchestrator.js` rewrite):
  - 3 sections now processed in parallel via `Promise.all`
  - Within each section, Kling video generation and TTS run in parallel
  - Only Lipsync runs sequentially (requires both video and audio as input)
  - Processing time reduced from ~35min to ~12min per video

- **CLI update** (`scripts/run-pipeline.js`):
  - New flags: `--video-id <ID>`, `--limit <N>`
  - `--character-folder` deprecated (still works for backward compatibility)
  - Pipeline reads from inventory sheets instead of scenario.json

- **Deprecations**:
  - `pipeline/data/scenario.json`: No longer the primary data source; inventories are used instead
  - `--character-folder` CLI flag: Replaced by `--video-id`

- **Config updates** (`pipeline/config.js`):
  - Added `ACCOUNTS_SPREADSHEET_ID` for Accounts Inventory
  - Added `productionTab` configuration

**Key decisions:**
1. **Parallel Promise.all for 3 sections**: Each section is independent until lipsync, so process all 3 simultaneously
2. **Kling + TTS parallel within sections**: Video generation and audio generation don't depend on each other
3. **Production tab replaces content_pipeline for new runs**: Cleaner schema with 32 columns, keeps legacy data intact
4. **Inventory-driven pipeline**: scenario.json was static and limiting; reading from Sheets allows dynamic content selection
5. **Backward compatibility maintained**: `--character-folder` still works, content_pipeline tab preserved

**Files changed/created:**
- New: `pipeline/sheets/inventory-reader.js`, `pipeline/sheets/production-manager.js`
- Modified: `pipeline/orchestrator.js` (parallel rewrite), `pipeline/config.js` (accounts ID, productionTab), `scripts/run-pipeline.js` (new CLI flags)
- Deprecated: `pipeline/data/scenario.json`
- Docs: `STRATEGY.md`, `ARCHITECTURE.md`, `README.md`, `CONTEXT.md` all updated

**New Resource IDs:**
| Resource | ID |
|----------|-----|
| Accounts Inventory | `1CmT6C3qCW3md6lJ9Rvc2WNQkWa5zcvlq6Zp_enJHoUE` |

**Test results:** 357 tests passing (330 GAS + 27 pipeline)

**Bug fixes (same session):**
- `drive_file_id` column missing from Motions/Characters inventories â†’ added to both
- `extractDriveFileId()` helper added to orchestrator.js: defensive fallback that extracts file ID from `drive_file_id` field or parses it from `file_link` URL patterns
- `fal-client.js`: enriched error messages now include fal.ai body details (e.g., balance exhausted reason)

**E2E real API result (v4.0 parallel pipeline â€” SUCCESS):**
- VID_202602_0001: 3 sections parallel, 1030s (17.2min) total
- Hook: 9.2MB, Body: 78.4MB, CTA: 17.3MB, Final: 104.9MB (100MB)
- Drive folder: `1IiMhXW7WfyCWADSj-aNF_-AWuzuv-pyy`
- Production tab auto-updated: pipeline_status=completed, all 4 video URLs, processing_time=1030s
- All API steps succeeded: character upload â†’ 3Ã— (motion upload + Kling + TTS parallel + Lipsync) â†’ ffmpeg â†’ Drive

**New documentation:**
- `OPERATIONS.md`: 667-line Japanese operations manual for human operators
  - Covers: inventory management, production workflow, CLI usage, troubleshooting, cost reference

### 2026-02-11: Documentation Audit & Reorganization

**Why:** ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒæ ¹å¹¹ãƒ¬ãƒ™ãƒ«ã«æ•£ä¹±ã—ã€æŠ€è¡“æƒ…å ±ã¨ãƒ“ã‚¸ãƒã‚¹æƒ…å ±ãŒæ··åœ¨ã—ã€åŒã˜æƒ…å ±ãŒè¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã«é‡è¤‡ã—ã¦ã„ãŸã€‚50â†’3,500ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã«å‚™ãˆã€ãƒãƒ¼ãƒ ãƒ¡ã‚¤ãƒˆãŒè¿·ã‚ãšå‚ç…§ã§ãã‚‹ä½“åˆ¶ã‚’æ•´å‚™ã€‚

**What was done:**

- **ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã®å†ç·¨æˆ**:
  - `STRATEGY.md` â†’ `docs/STRATEGY.md`
  - `ARCHITECTURE.md` â†’ `docs/ARCHITECTURE.md`
  - `OPERATIONS.md` â†’ `docs/manuals/OPERATIONS.md`
  - `MANUAL.md` â†’ `docs/manuals/GAS_MANUAL.md`
  - `docs/USER_GUIDE.md` â†’ `docs/manuals/USER_GUIDE.md`
  - `docs/account-design-guide.md` â†’ `docs/manuals/account-design-guide.md`
  - ãƒ«ãƒ¼ãƒˆã«ã¯ `README.md` ã¨ `CONTEXT.md` ã®ã¿æ®‹ã™

- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒãƒªã‚·ãƒ¼ç¢ºç«‹**:
  - **README.md**: æŠ€è¡“SSOTï¼ˆã‚¹ã‚­ãƒ¼ãƒã€ã‚³ã‚¹ãƒˆã€Driveæ§‹é€ ã®å”¯ä¸€ã®å®šç¾©å ´æ‰€ï¼‰
  - **docs/STRATEGY.md**: ãƒ“ã‚¸ãƒã‚¹å°‚ç”¨ï¼ˆKPIã€åç›Šã€ãƒ•ã‚§ãƒ¼ã‚ºã€ãƒªã‚¹ã‚¯ã€æ„æ€æ±ºå®šï¼‰â€” æŠ€è¡“çš„ãªä»•æ§˜ã¯å«ã‚ãªã„
  - **docs/ARCHITECTURE.md**: ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“å›³ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§
  - **docs/manuals/**: äººé–“ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼å‘ã‘ã‚¬ã‚¤ãƒ‰
  - **é‡è¤‡ç¦æ­¢**: å„æƒ…å ±ã¯1ç®‡æ‰€ã®ã¿ã«è¨˜è¼‰ã—ã€ä»–ã¯ã‚¯ãƒ­ã‚¹ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

- **é‡è¤‡ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®é™¤å»**:
  - ARCHITECTURE.md: Sheetsã‚¹ã‚­ãƒ¼ãƒï¼ˆ110è¡Œï¼‰ã€ã‚³ã‚¹ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ20è¡Œï¼‰ã‚’å‰Šé™¤ â†’ READMEå‚ç…§ã«å¤‰æ›´
  - OPERATIONS.md: ã‚³ã‚¹ãƒˆå‚è€ƒï¼ˆ27è¡Œï¼‰ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚¹ã‚­ãƒ¼ãƒä¸€è¦§ï¼ˆ82è¡Œï¼‰ã‚’å‰Šé™¤ â†’ READMEå‚ç…§ã«å¤‰æ›´

- **KPIæ•°å€¤æ›´æ–°**ï¼ˆãƒã‚¹ã‚¿ãƒ¼ã‚·ãƒ¼ãƒˆ.xlsxã‹ã‚‰ï¼‰:
  - 5æœˆ: 520 â†’ **1,480** ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
  - 6æœˆ: 700 â†’ **3,500** ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ

- **ã‚¯ãƒ­ã‚¹ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ä¿®æ­£**: å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒªãƒ³ã‚¯ã‚’æ–°ãƒ‘ã‚¹ã«æ›´æ–°

- **account-design-guide.md**: ãƒãƒ¼ãƒ ãƒ¡ã‚¤ãƒˆå‘ã‘ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­è¨ˆã‚¬ã‚¤ãƒ‰ä½œæˆï¼ˆãƒšãƒ«ã‚½ãƒŠè¨­è¨ˆã€ç”»åƒæº–å‚™ã€ã‚·ãƒŠãƒªã‚ªä½œæˆã€ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªç™»éŒ²æ‰‹é †ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€FAQï¼‰

- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»**: gitå±¥æ­´ãƒ»å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¼æ´©ãŒãªã„ã“ã¨ã‚’ç¢ºèª

**Commits:**
- `85ae670` Docs: audit cleanup â€” add docs index, fix stale refs, remove secrets
- `940ca10` Docs: add account design guide + tech stack table
- `6f4db09` Docs: reorganize structure, deduplicate content, update KPI numbers

### 2026-02-11: ã‚³ã‚¹ãƒˆåˆ†æ & ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

**Why:** ã‚³ã‚¹ãƒˆè¨ˆç®—ãŒ10ç§’ãƒ™ãƒ¼ã‚¹ã§ç®—å‡ºã•ã‚Œã¦ã„ãŸãŒã€å®Ÿéš›ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­å®šã¯5ç§’/ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã€‚æ­£ç¢ºãªå˜ä¾¡ã«ä¿®æ­£ã—ã€ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼å‘ã‘ã®è©³ç´°ã‚³ã‚¹ãƒˆåˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã€‚ã¾ãŸã€50â†’3,500ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã«å‘ã‘ãŸå…¨ä½“ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆã¨ SNS API èª¿æŸ»ãŒå¿…è¦ã ã£ãŸã€‚

**What was done:**

- **ã‚³ã‚¹ãƒˆä¿®æ­£** ($3.72/æœ¬ â†’ $2.34/æœ¬):
  - Kling: $0.70 â†’ $0.35ï¼ˆ5ç§’Ã—$0.07/ç§’ï¼‰
  - ElevenLabs: ~$0.04 â†’ ~$0.01
  - Lipsync: $0.50 â†’ $0.42ï¼ˆ5ç§’/60Ã—$5.00/åˆ†ï¼‰
  - README.md, ARCHITECTURE.md, OPERATIONS.md ã‚’å…¨ã¦æ›´æ–°

- **æ–°è¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**:
  - `docs/cost-analysis/per-video-cost.md`: 1å‹•ç”»ã‚ãŸã‚Šã®APIè²»ç”¨å†…è¨³
  - `docs/cost-analysis/per-minute-cost.md`: åˆ†å˜ä¾¡æ¯”è¼ƒï¼ˆAPI vs GUIã€ä»–ç¤¾ã‚µãƒ¼ãƒ“ã‚¹æ¯”è¼ƒï¼‰
  - `docs/cost-analysis/full-system-design.md`: å…¨9ãƒ•ã‚§ãƒ¼ã‚ºã®ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸ï¼ˆ614è¡Œï¼‰
    - å¸‚å ´ãƒªã‚µãƒ¼ãƒ â†’ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­è¨ˆ â†’ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆ â†’ æŠ•ç¨¿ â†’ è¨ˆæ¸¬ â†’ åˆ†æ â†’ æ”¹å–„ã®ãƒ•ãƒ«ãƒ«ãƒ¼ãƒ—
    - æœˆåˆ¥ã‚³ã‚¹ãƒˆè©¦ç®—ï¼ˆ2æœˆã€œ6æœˆï¼‰ã€Pro/Std 2ãƒ—ãƒ©ãƒ³æ¯”è¼ƒ
    - ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆã€ä¸¦åˆ—åŒ–æˆ¦ç•¥ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™åˆ†æ
  - `docs/research/SNS_API_RESEARCH.md`: 4ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®APIèª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆï¼ˆ615è¡Œï¼‰
    - YouTube / TikTok / Instagram / X ã®æŠ•ç¨¿APIä»•æ§˜ã€åˆ¶é™ã€èªè¨¼æ–¹å¼

- **STRATEGY.mdæ›´æ–°**: ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸ãƒ»SNSç ”ç©¶ã¸ã®ã‚¯ãƒ­ã‚¹ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹è¿½åŠ 

**Commits:**
- `9ef6f94` Docs: add cost analysis reports, fix API pricing across all docs
- `0e3f3eb` Docs: add full system design & SNS API research for 50â†’3,500 account scaling

### 2026-02-11: ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— & ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¿®æ­£

**Why:** Tailscale VPNã®æ¥ç¶šä¸å®‰å®šï¼ˆæ±äº¬ãƒªãƒ¬ãƒ¼éšœå®³ã€å…¨ãƒªãƒ¼ã‚¸ãƒ§ãƒ³~2sãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ï¼‰ã«ã‚ˆã‚Šã€VMä¸Šã§ã®é–‹ç™ºä½œæ¥­ãŒå›°é›£ã«ã€‚GitHubã‹ã‚‰ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ä½œæ¥­ç’°å¢ƒã‚’æ§‹ç¯‰ã€‚

**What was done:**

- **ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒæ§‹ç¯‰**:
  - `gh repo clone Ceed-dev/ai-influencer` ã§ ~/Programming/ai-influencer ã«ã‚¯ãƒ­ãƒ¼ãƒ³
  - SCPçµŒç”±ã§VMã‹ã‚‰ç§˜å¯†ãƒ•ã‚¡ã‚¤ãƒ«3ç‚¹ã‚’å–å¾—: `.env`, `.gsheets_token.json`, `video_analytics_hub_claude_code_oauth.json`
  - `npm install` å®Ÿè¡Œï¼ˆ313ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰
  - Google Sheets APIæ¥ç¶šç¢ºèªï¼ˆproductionã‚¿ãƒ–èª­å–OKï¼‰
  - Google Drive APIæ¥ç¶šç¢ºèª
  - å…¨357ãƒ†ã‚¹ãƒˆãƒ‘ã‚¹ï¼ˆ330 GAS + 27 pipelineï¼‰

- **STRATEGY.mdä¿®æ­£**:
  - æŠ•ç¨¿é »åº¦ã®è¨˜è¿°ã‚’ä¿®æ­£: ã€Œ7æœ¬/é€±ã€â†’ã€Œ1æ—¥1æœ¬/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆæ—¥æ¬¡ç·æŠ•ç¨¿æ•° = ç¨¼åƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ•°ï¼‰ã€
  - åˆ†æãƒ»æ”¹å–„ãƒ•ã‚§ãƒ¼ã‚ºã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ğŸŸ¢è‡ªå‹• â†’ ğŸ”´å®Ÿè£…é€”ä¸­ã«ä¿®æ­£ï¼ˆåŸºç›¤å®Ÿè£…æ¸ˆã¿ã ãŒæœ¬ç•ªé‹ç”¨æœªé–‹å§‹ï¼‰
  - å¸‚å ´ãƒªã‚µãƒ¼ãƒç”¨ã‚·ãƒ¼ãƒˆæº–å‚™ã‚¿ã‚¹ã‚¯ã‚’ç›´è¿‘ã®å„ªå…ˆäº‹é …ã«è¿½åŠ ï¼ˆ2/14ä½¿ç”¨é–‹å§‹ã€Badhanä½œæˆâ†’é§¿å†´FBï¼‰

**Key notes:**
- VMã®refresh_tokenãŒãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚‚ãã®ã¾ã¾æœ‰åŠ¹ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶OAuthèªè¨¼ä¸è¦ï¼‰
- client.jsã®è‡ªå‹•ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥æ©Ÿæ§‹ã«ã‚ˆã‚Šã€æœŸé™åˆ‡ã‚Œãƒˆãƒ¼ã‚¯ãƒ³ã‚‚è‡ªå‹•æ›´æ–°
- Tailscale Exit Nodeã¯æœªè¨­å®šã®ãŸã‚ã€ä¸€èˆ¬ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¯VPNçµŒç”±ã›ãšç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹

### 2026-02-12: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ä»•æ§˜ç¢ºèª & æœªå®Ÿè£…æ©Ÿèƒ½ã®æ´—ã„å‡ºã—

**Why:** 36å‹•ç”»/æ—¥ã®é‡ç”£é‹ç”¨ã«å‘ã‘ã¦ã€ç¾çŠ¶ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒå®Ÿéš›ã«ãã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‚’é”æˆã§ãã‚‹ã‹ã®ç¢ºèªã€‚

**ç¢ºèªçµæœ â€” ç¾çŠ¶ã®ã‚®ãƒ£ãƒƒãƒ—:**

1. **ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€Œãƒ¬ã‚·ãƒ”å®Ÿè¡Œå™¨ã€**: productionã‚·ãƒ¼ãƒˆã«`edit_status=ready`ã®è¡ŒãŒã‚ã‚‹å ´åˆã®ã¿å‹•ç”»ã‚’ç”Ÿæˆã™ã‚‹ã€‚ä½•ã‚’ä½œã‚‹ã‹è‡ªä½“ã¯æ±ºã‚ãªã„ã€‚ã¤ã¾ã‚Šæ¯æ—¥36æœ¬ä½œã‚‹ã«ã¯ã€æ¯æ—¥36è¡Œã®ãƒ¬ã‚·ãƒ”ï¼ˆaccount_id, scenario_id, motion_id, character_id, audio_id, scriptsï¼‰ã‚’productionã‚·ãƒ¼ãƒˆã«æ›¸ãè¾¼ã‚€å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã®è‡ªå‹•åŒ–ã¯æœªå®Ÿè£…ã€‚

2. **ãƒ—ãƒ¼ãƒ«åˆ¶å¾¡ï¼ˆæœªå®Ÿè£…ï¼‰**: å‹•ç”»ãƒ—ãƒ¼ãƒ«ãŒä¸€å®šæ•°ï¼ˆä¾‹:100æœ¬ï¼‰æºœã¾ã£ãŸã‚‰åœæ­¢ã€æ¶ˆè²»ã•ã‚ŒãŸã‚‰å†é–‹ã™ã‚‹ä»•çµ„ã¿ãŒãªã„ã€‚ç¾çŠ¶ã¯æ‰‹å‹•ã§`--limit N`ã‚’å©ãé‹ç”¨ã€‚

3. **å‹•ç”»ä¸¦åˆ—ç”Ÿæˆï¼ˆæœªå®Ÿè£…ï¼‰**: ç¾çŠ¶ã¯1æœ¬ãšã¤é †æ¬¡å‡¦ç†ï¼ˆå„æœ¬å†…ã®3ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ä¸¦åˆ—ï¼‰ã€‚36æœ¬é †æ¬¡ = ~7.2æ™‚é–“ã€‚è¤‡æ•°æœ¬ã®åŒæ™‚ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã¯æœªå®Ÿè£…ã€‚

4. **æŠ•ç¨¿ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹é †æ›¸ï¼ˆæœªä½œæˆï¼‰**: ã€Œæ¯æ—¥ã©ã®ã‚·ãƒ¼ãƒˆã‚’è¦‹ã¦ã€ã©ã“ã‹ã‚‰DLã—ã¦ã€æŠ•ç¨¿å¾Œã«ã©ã“ã‚’æ›´æ–°ã™ã‚‹ã‹ã€ã®æ‰‹é †æ›¸ãŒãªã„ã€‚

**fal.aiã‚¯ãƒ¬ã‚¸ãƒƒãƒˆè©¦ç®—:**
- 36æœ¬/æ—¥ Ã— $2.34/æœ¬ = $84.24/æ—¥
- ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ1å›: ~$100ï¼ˆãƒªãƒˆãƒ©ã‚¤ä½™è£•å«ã‚€ï¼‰
- $1,000è³¼å…¥ã§40ä¸¦è¡Œã‚¿ã‚¹ã‚¯ã‚¢ãƒ³ãƒ­ãƒƒã‚¯ï¼ˆæœ¬ç•ªé‹ç”¨å‘ã‘ï¼‰

## Current System State (as of 2026-02-12)

### Deployed and Working (GAS Analytics v2.0)
- Master Spreadsheet with all 9 tabs initialized and formatted
- 4 Component Inventory spreadsheets (Scenarios, Motions, Characters, Audio)
- Google Drive folder structure (AI-Influencer root with all subfolders)
- Web App deployed with anonymous access
- OpenAI integration working (via _config sheet fallback)
- Demo data: 3 videos (2 analyzed with metrics, 1 draft)
- Demo components: 7 scenarios, 5 motions, 3 characters, 4 audio
- All 330 GAS tests passing

### Implemented (Pipeline v4.0 - 2026-02-10) â€” Production Rebuild
- All inventory spreadsheets populated with real data (ãƒ†ãƒ³ãƒ—ãƒ¬.xlsx)
- 3 motion videos uploaded to Drive (Hooks/Bodies/CTAs)
- Accounts Inventory: 7 accounts + 12 Gmail credentials
- Production tab: 32-column tracking in Master Spreadsheet
- `inventory-reader.js`: Reads inventories, resolves component IDs
- `production-manager.js`: Manages production tab CRUD
- Orchestrator parallelized: 3 sections via Promise.all, Kling+TTS parallel within sections
- Processing time: ~35min â†’ ~12min per video
- CLI: `node scripts/run-pipeline.js --video-id <ID> [--limit N] [--dry-run]`
- `--character-folder` deprecated (backward compatible)
- `scenario.json` deprecated (inventories used instead)
- 26 pipeline tests passing

### Implemented (Pipeline Phase 0 - 2026-02-10) â€” E2E Verified
- Content generation pipeline: character image â†’ 3-section video â†’ Drive â€” **working end-to-end**
- First successful E2E: CNT_202602_2916 (54MB final video, ~35min processing time)
- 3 media modules (Kling motion-control, ElevenLabs eleven-v3, Lipsync v2/pro)
- fal.storage upload (replaces Cloudinary)
- ffmpeg concat utility for 3-section video joining
- content_pipeline sheet with schema (15 columns) â€” 3 records (2 error during dev, 1 completed)
- Character image CHR_0001_v1.jpg uploaded to Drive `Characters/Images/CHR_0001/`
- Output stored at `Productions/2026-02-10/CNT_202602_2916/` (4 MP4 files)

### Documentation (2026-02-11 reorganized)
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒãƒªã‚·ãƒ¼ç¢ºç«‹: README=æŠ€è¡“SSOT, STRATEGY=ãƒ“ã‚¸ãƒã‚¹å°‚ç”¨, é‡è¤‡ç¦æ­¢
- ã‚³ã‚¹ãƒˆè¨ˆç®—ä¿®æ­£: $3.72 â†’ $2.34/æœ¬ï¼ˆ5ç§’/ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‰
- å…¨9ãƒ•ã‚§ãƒ¼ã‚ºã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸ + SNS APIèª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆä½œæˆæ¸ˆã¿
- account-design-guide: ãƒãƒ¼ãƒ ãƒ¡ã‚¤ãƒˆå‘ã‘ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­è¨ˆã‚¬ã‚¤ãƒ‰ä½œæˆæ¸ˆã¿

### Pending
- YouTube OAuth ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆæœ€åˆã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‘ã‘ï¼‰
- Platform posting automationï¼ˆYouTube â†’ Instagram â†’ TikTok â†’ Xï¼‰
- Batch execution with `--limit` for multiple videos
- Metrics collection automation
- GAS analytics integration with production tab data
- ClipPulse integration for market research (under consideration)
- OpenClaw integration for operation automation (under consideration)

### Files in Repository
```
gas/                            # GAS analytics (unchanged since v2.0)
  Code.gs                       # Web App endpoints + UI menu (1157 lines)
  Config.gs                     # Settings, schema, constants (389 lines)
  Setup.gs                      # One-click system setup (762 lines)
  Migration.gs                  # v1 to v2 migration (224 lines)
  CSVParser.gs                  # Platform-specific CSV parsers (190 lines)
  Normalizer.gs                 # Unified schema conversion (208 lines)
  Linker.gs                     # video_uid matching (238 lines)
  KPIEngine.gs                  # KPI comparison (249 lines)
  LLMAnalyzer.gs                # OpenAI integration (665 lines)
  SheetWriter.gs                # Sheet write operations (275 lines)
  ComponentManager.gs           # Component CRUD + context (283 lines)
  MasterManager.gs              # Master sheet + workflow (255 lines)
  ScoreUpdater.gs               # Component scoring (212 lines)
  Utils.gs                      # ID generators, helpers (544 lines)
  appsscript.json               # GAS manifest
  tests/                        # 9 test suites, 330 tests

pipeline/                       # Node.js content pipeline (v4.0)
  config.js                     # Environment configuration
  orchestrator.js               # 3-section parallel pipeline (Promise.all)
  data/scenario.json            # Scenario template (DEPRECATED)
  sheets/client.js              # Google Sheets/Drive API (OAuth2)
  sheets/inventory-reader.js    # Inventory reader + ID resolution (v4.0)
  sheets/production-manager.js  # Production tab CRUD (v4.0)
  sheets/account-manager.js     # Accounts tab CRUD
  sheets/content-manager.js     # Content pipeline tab CRUD (legacy)
  media/fal-client.js           # fal.ai SDK + fal.storage upload + Drive download
  media/video-generator.js      # Kling v2.6 motion-control
  media/tts-generator.js        # ElevenLabs eleven-v3 (voice: Aria)
  media/lipsync.js              # Sync Lipsync v2/pro (sync_mode: bounce)
  media/concat.js               # ffmpeg concat demuxer
  storage/drive-storage.js      # Video URL â†’ Drive upload
  posting/poster.js             # Unified posting interface (stub)
  posting/adapters/*.js         # Platform adapters (stubs)

tests/                          # Pipeline tests
  pipeline.test.js              # 27 tests

scripts/                        # CLI entry points
  run-pipeline.js               # --video-id <ID> [--limit N] [--dry-run]
  run-daily.js                  # Daily batch execution (stub)
  collect-metrics.js            # Metrics collection (stub)
  gsheet.py                     # Google Sheets CLI utility

docs/                           # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ2026-02-11 å†ç·¨æˆæ¸ˆã¿ï¼‰
  STRATEGY.md                   # ãƒ“ã‚¸ãƒã‚¹æˆ¦ç•¥ï¼ˆKPI, åç›Š, ãƒ•ã‚§ãƒ¼ã‚º, æ„æ€æ±ºå®šï¼‰
  ARCHITECTURE.md               # æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆã‚·ã‚¹ãƒ†ãƒ å›³, ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ï¼‰
  n8n-integration.md            # n8n ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼é€£æºã‚¬ã‚¤ãƒ‰
  cost-analysis/
    per-video-cost.md           # 1å‹•ç”»ã‚ãŸã‚ŠAPIè²»ç”¨å†…è¨³
    per-minute-cost.md          # åˆ†å˜ä¾¡æ¯”è¼ƒï¼ˆAPI vs GUIï¼‰
    full-system-design.md       # å…¨9ãƒ•ã‚§ãƒ¼ã‚º ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸
  research/
    SNS_API_RESEARCH.md         # SNS API èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆï¼ˆYT/TT/IG/Xï¼‰
  manuals/
    OPERATIONS.md               # é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ï¼ˆæ—¥æœ¬èªï¼‰
    GAS_MANUAL.md               # GASæ“ä½œãƒãƒ‹ãƒ¥ã‚¢ãƒ«ï¼ˆæ—¥æœ¬èªï¼‰
    USER_GUIDE.md               # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰ï¼ˆæ—¥æœ¬èªï¼‰
    account-design-guide.md     # ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­è¨ˆã‚¬ã‚¤ãƒ‰ï¼ˆãƒãƒ¼ãƒ å‘ã‘ï¼‰

README.md                       # æŠ€è¡“SSOTï¼ˆã‚¹ã‚­ãƒ¼ãƒ, ã‚³ã‚¹ãƒˆ, Driveæ§‹é€ ï¼‰
CONTEXT.md                      # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå±¥æ­´ï¼ˆã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
```


## Technical Notes

### Platform CSV Column Variations

YouTube may change column names between exports. Known variations:
- "Views" / "View count" / "è¦–è´å›æ•°"
- "Watch time (hours)" / "ç·å†ç”Ÿæ™‚é–“ï¼ˆæ™‚é–“ï¼‰"

TikTok variations:
- "Video views" / "Views"
- "Average watch time" / "Avg. watch time"

Instagram variations:
- "Plays" / "Views"
- "Reach" / "Accounts reached"

### GAS Limitations to Remember
- 6-minute execution timeout
- 20MB response size limit
- 100 triggers per user limit
- Properties Service: 500KB total, 9KB per property

### OpenAI Integration Notes
- Use TSV output format for structured responses (more reliable parsing than JSON)
- Batch multiple videos per request to reduce API calls
- Implement exponential backoff for rate limiting
- v2.0: Include component context for better recommendations

### v2.0 Component Score System
- Each analyzed video's overall_score contributes to its components' avg_performance_score
- Scores normalized 0-100 across platforms
- Top-performing components surfaced in AI recommendation prompts
- Score updates cascade: video analyzed -> master updated -> all linked components updated

### Sensitive Data Locations (NOT in git)
- `.clasp.json` - clasp config with Script ID
- `.gsheets_token.json` - OAuth token for Sheets/Drive API
- `video_analytics_hub_*oauth*.json` - OAuth client credentials
- `client_secret_*.json` - Google Cloud client secrets
- `.mcp.json` - MCP server config with OAuth credentials
- `_config` sheet in spreadsheet - contains OpenAI API key
